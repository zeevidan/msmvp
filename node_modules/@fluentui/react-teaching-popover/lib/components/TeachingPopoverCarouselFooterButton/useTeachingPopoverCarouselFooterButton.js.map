{"version":3,"sources":["../src/components/TeachingPopoverCarouselFooterButton/useTeachingPopoverCarouselFooterButton.ts"],"sourcesContent":["import * as React from 'react';\nimport { getIntrinsicElementProps, mergeCallbacks, slot } from '@fluentui/react-utilities';\nimport type {\n  TeachingPopoverCarouselFooterButtonProps,\n  TeachingPopoverCarouselFooterButtonState,\n} from './TeachingPopoverCarouselFooterButton.types';\nimport { usePopoverContext_unstable } from '@fluentui/react-popover';\nimport { useCarouselContext_unstable } from '../TeachingPopoverCarousel/Carousel/CarouselContext';\nimport { useEventCallback } from '@fluentui/react-utilities';\nimport { useButton_unstable } from '@fluentui/react-button';\nimport { useCarouselValues_unstable } from '../TeachingPopoverCarousel/Carousel/useCarouselValues';\n\n/**\n * Create the state required to render TeachingPopoverCarouselFooterButton.\n *\n * The returned state can be modified with hooks such as useTeachingPopoverCarouselFooterButtonStyles_unstable,\n * before being passed to renderTeachingPopoverCarouselFooterButton_unstable.\n *\n * @param props - props from this instance of TeachingPopoverCarouselFooterButton\n * @param ref - reference to root HTMLDivElement of TeachingPopoverCarouselFooterButton\n */\nexport const useTeachingPopoverCarouselFooterButton_unstable = (\n  props: TeachingPopoverCarouselFooterButtonProps,\n  ref: React.Ref<HTMLButtonElement | HTMLAnchorElement>,\n): TeachingPopoverCarouselFooterButtonState => {\n  const { navType, altText } = props;\n\n  const popoverAppearance = usePopoverContext_unstable(context => context.appearance);\n  const selectPageByDirection = useCarouselContext_unstable(c => c.selectPageByDirection);\n  const values = useCarouselValues_unstable(snapshot => snapshot);\n  const activeValue = useCarouselContext_unstable(c => c.value);\n\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement & HTMLAnchorElement>) => {\n    if (event.isDefaultPrevented()) {\n      return;\n    }\n\n    selectPageByDirection(event, navType);\n  };\n\n  const handleButtonClick = useEventCallback(mergeCallbacks(handleClick, props.onClick));\n\n  const isTrailing = React.useMemo(() => {\n    if (!activeValue) {\n      return false;\n    }\n\n    if (navType === 'prev') {\n      return values.indexOf(activeValue) === 0;\n    }\n\n    return values.indexOf(activeValue) === values.length - 1;\n  }, [navType, activeValue, values]);\n\n  let buttonAppearanceType: 'primary' | 'outline' | undefined;\n\n  if (navType === 'next') {\n    buttonAppearanceType = popoverAppearance === 'brand' ? undefined : 'primary';\n  } else {\n    buttonAppearanceType = popoverAppearance === 'brand' ? 'outline' : undefined;\n  }\n\n  /* Handle altText on trailing step */\n  let buttonChild = props.children;\n  if (isTrailing) {\n    buttonChild = altText;\n  }\n\n  return {\n    ...useButton_unstable({ appearance: buttonAppearanceType, ...props }, ref),\n    navType,\n    popoverAppearance,\n    altText,\n    // Override useButton root slot\n    root: slot.always(\n      getIntrinsicElementProps('button', {\n        ref,\n        appearance: buttonAppearanceType,\n        ...props,\n        onClick: handleButtonClick,\n        children: buttonChild,\n      }),\n      { elementType: 'button' },\n    ),\n  };\n};\n"],"names":["React","getIntrinsicElementProps","mergeCallbacks","slot","usePopoverContext_unstable","useCarouselContext_unstable","useEventCallback","useButton_unstable","useCarouselValues_unstable","useTeachingPopoverCarouselFooterButton_unstable","props","ref","navType","altText","popoverAppearance","context","appearance","selectPageByDirection","c","values","snapshot","activeValue","value","handleClick","event","isDefaultPrevented","handleButtonClick","onClick","isTrailing","useMemo","indexOf","length","buttonAppearanceType","undefined","buttonChild","children","root","always","elementType"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,wBAAwB,EAAEC,cAAc,EAAEC,IAAI,QAAQ,4BAA4B;AAK3F,SAASC,0BAA0B,QAAQ,0BAA0B;AACrE,SAASC,2BAA2B,QAAQ,sDAAsD;AAClG,SAASC,gBAAgB,QAAQ,4BAA4B;AAC7D,SAASC,kBAAkB,QAAQ,yBAAyB;AAC5D,SAASC,0BAA0B,QAAQ,wDAAwD;AAEnG;;;;;;;;CAQC,GACD,OAAO,MAAMC,kDAAkD,CAC7DC,OACAC;IAEA,MAAM,EAAEC,OAAO,EAAEC,OAAO,EAAE,GAAGH;IAE7B,MAAMI,oBAAoBV,2BAA2BW,CAAAA,UAAWA,QAAQC,UAAU;IAClF,MAAMC,wBAAwBZ,4BAA4Ba,CAAAA,IAAKA,EAAED,qBAAqB;IACtF,MAAME,SAASX,2BAA2BY,CAAAA,WAAYA;IACtD,MAAMC,cAAchB,4BAA4Ba,CAAAA,IAAKA,EAAEI,KAAK;IAE5D,MAAMC,cAAc,CAACC;QACnB,IAAIA,MAAMC,kBAAkB,IAAI;YAC9B;QACF;QAEAR,sBAAsBO,OAAOZ;IAC/B;IAEA,MAAMc,oBAAoBpB,iBAAiBJ,eAAeqB,aAAab,MAAMiB,OAAO;IAEpF,MAAMC,aAAa5B,MAAM6B,OAAO,CAAC;QAC/B,IAAI,CAACR,aAAa;YAChB,OAAO;QACT;QAEA,IAAIT,YAAY,QAAQ;YACtB,OAAOO,OAAOW,OAAO,CAACT,iBAAiB;QACzC;QAEA,OAAOF,OAAOW,OAAO,CAACT,iBAAiBF,OAAOY,MAAM,GAAG;IACzD,GAAG;QAACnB;QAASS;QAAaF;KAAO;IAEjC,IAAIa;IAEJ,IAAIpB,YAAY,QAAQ;QACtBoB,uBAAuBlB,sBAAsB,UAAUmB,YAAY;IACrE,OAAO;QACLD,uBAAuBlB,sBAAsB,UAAU,YAAYmB;IACrE;IAEA,mCAAmC,GACnC,IAAIC,cAAcxB,MAAMyB,QAAQ;IAChC,IAAIP,YAAY;QACdM,cAAcrB;IAChB;IAEA,OAAO;QACL,GAAGN,mBAAmB;YAAES,YAAYgB;YAAsB,GAAGtB,KAAK;QAAC,GAAGC,IAAI;QAC1EC;QACAE;QACAD;QACA,+BAA+B;QAC/BuB,MAAMjC,KAAKkC,MAAM,CACfpC,yBAAyB,UAAU;YACjCU;YACAK,YAAYgB;YACZ,GAAGtB,KAAK;YACRiB,SAASD;YACTS,UAAUD;QACZ,IACA;YAAEI,aAAa;QAAS;IAE5B;AACF,EAAE"}