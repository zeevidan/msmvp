{"version":3,"sources":["../src/components/TeachingPopoverCarouselFooterButton/useTeachingPopoverCarouselFooterButton.ts"],"sourcesContent":["import * as React from 'react';\nimport { getIntrinsicElementProps, mergeCallbacks, slot } from '@fluentui/react-utilities';\nimport type {\n  TeachingPopoverCarouselFooterButtonProps,\n  TeachingPopoverCarouselFooterButtonState,\n} from './TeachingPopoverCarouselFooterButton.types';\nimport { usePopoverContext_unstable } from '@fluentui/react-popover';\nimport { useCarouselContext_unstable } from '../TeachingPopoverCarousel/Carousel/CarouselContext';\nimport { useEventCallback } from '@fluentui/react-utilities';\nimport { useButton_unstable } from '@fluentui/react-button';\nimport { useCarouselValues_unstable } from '../TeachingPopoverCarousel/Carousel/useCarouselValues';\n\n/**\n * Create the state required to render TeachingPopoverCarouselFooterButton.\n *\n * The returned state can be modified with hooks such as useTeachingPopoverCarouselFooterButtonStyles_unstable,\n * before being passed to renderTeachingPopoverCarouselFooterButton_unstable.\n *\n * @param props - props from this instance of TeachingPopoverCarouselFooterButton\n * @param ref - reference to root HTMLDivElement of TeachingPopoverCarouselFooterButton\n */\nexport const useTeachingPopoverCarouselFooterButton_unstable = (\n  props: TeachingPopoverCarouselFooterButtonProps,\n  ref: React.Ref<HTMLButtonElement | HTMLAnchorElement>,\n): TeachingPopoverCarouselFooterButtonState => {\n  const { navType, altText } = props;\n\n  const popoverAppearance = usePopoverContext_unstable(context => context.appearance);\n  const selectPageByDirection = useCarouselContext_unstable(c => c.selectPageByDirection);\n  const values = useCarouselValues_unstable(snapshot => snapshot);\n  const activeValue = useCarouselContext_unstable(c => c.value);\n\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement & HTMLAnchorElement>) => {\n    if (event.isDefaultPrevented()) {\n      return;\n    }\n\n    selectPageByDirection(event, navType);\n  };\n\n  const handleButtonClick = useEventCallback(mergeCallbacks(handleClick, props.onClick));\n\n  const isTrailing = React.useMemo(() => {\n    if (!activeValue) {\n      return false;\n    }\n\n    if (navType === 'prev') {\n      return values.indexOf(activeValue) === 0;\n    }\n\n    return values.indexOf(activeValue) === values.length - 1;\n  }, [navType, activeValue, values]);\n\n  let buttonAppearanceType: 'primary' | 'outline' | undefined;\n\n  if (navType === 'next') {\n    buttonAppearanceType = popoverAppearance === 'brand' ? undefined : 'primary';\n  } else {\n    buttonAppearanceType = popoverAppearance === 'brand' ? 'outline' : undefined;\n  }\n\n  /* Handle altText on trailing step */\n  let buttonChild = props.children;\n  if (isTrailing) {\n    buttonChild = altText;\n  }\n\n  return {\n    ...useButton_unstable({ appearance: buttonAppearanceType, ...props }, ref),\n    navType,\n    popoverAppearance,\n    altText,\n    // Override useButton root slot\n    root: slot.always(\n      getIntrinsicElementProps('button', {\n        ref,\n        appearance: buttonAppearanceType,\n        ...props,\n        onClick: handleButtonClick,\n        children: buttonChild,\n      }),\n      { elementType: 'button' },\n    ),\n  };\n};\n"],"names":["useTeachingPopoverCarouselFooterButton_unstable","props","ref","navType","altText","popoverAppearance","usePopoverContext_unstable","context","appearance","selectPageByDirection","useCarouselContext_unstable","c","values","useCarouselValues_unstable","snapshot","activeValue","value","handleClick","event","isDefaultPrevented","handleButtonClick","useEventCallback","mergeCallbacks","onClick","isTrailing","React","useMemo","indexOf","length","buttonAppearanceType","undefined","buttonChild","children","useButton_unstable","root","slot","always","getIntrinsicElementProps","elementType"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAqBaA;;;eAAAA;;;;iEArBU;gCACwC;8BAKpB;iCACC;6BAET;mCACQ;AAWpC,MAAMA,kDAAkD,CAC7DC,OACAC;IAEA,MAAM,EAAEC,OAAO,EAAEC,OAAO,EAAE,GAAGH;IAE7B,MAAMI,oBAAoBC,IAAAA,wCAAAA,EAA2BC,CAAAA,UAAWA,QAAQC,UAAU;IAClF,MAAMC,wBAAwBC,IAAAA,4CAAAA,EAA4BC,CAAAA,IAAKA,EAAEF,qBAAqB;IACtF,MAAMG,SAASC,IAAAA,6CAAAA,EAA2BC,CAAAA,WAAYA;IACtD,MAAMC,cAAcL,IAAAA,4CAAAA,EAA4BC,CAAAA,IAAKA,EAAEK,KAAK;IAE5D,MAAMC,cAAc,CAACC;QACnB,IAAIA,MAAMC,kBAAkB,IAAI;YAC9B;QACF;QAEAV,sBAAsBS,OAAOf;IAC/B;IAEA,MAAMiB,oBAAoBC,IAAAA,gCAAAA,EAAiBC,IAAAA,8BAAAA,EAAeL,aAAahB,MAAMsB,OAAO;IAEpF,MAAMC,aAAaC,OAAMC,OAAO,CAAC;QAC/B,IAAI,CAACX,aAAa;YAChB,OAAO;QACT;QAEA,IAAIZ,YAAY,QAAQ;YACtB,OAAOS,OAAOe,OAAO,CAACZ,iBAAiB;QACzC;QAEA,OAAOH,OAAOe,OAAO,CAACZ,iBAAiBH,OAAOgB,MAAM,GAAG;IACzD,GAAG;QAACzB;QAASY;QAAaH;KAAO;IAEjC,IAAIiB;IAEJ,IAAI1B,YAAY,QAAQ;QACtB0B,uBAAuBxB,sBAAsB,UAAUyB,YAAY;IACrE,OAAO;QACLD,uBAAuBxB,sBAAsB,UAAU,YAAYyB;IACrE;IAEA,mCAAmC,GACnC,IAAIC,cAAc9B,MAAM+B,QAAQ;IAChC,IAAIR,YAAY;QACdO,cAAc3B;IAChB;IAEA,OAAO;QACL,GAAG6B,IAAAA,+BAAAA,EAAmB;YAAEzB,YAAYqB;YAAsB,GAAG5B,KAAK;QAAC,GAAGC,IAAI;QAC1EC;QACAE;QACAD;QACA,+BAA+B;QAC/B8B,MAAMC,oBAAAA,CAAKC,MAAM,CACfC,IAAAA,wCAAAA,EAAyB,UAAU;YACjCnC;YACAM,YAAYqB;YACZ,GAAG5B,KAAK;YACRsB,SAASH;YACTY,UAAUD;QACZ,IACA;YAAEO,aAAa;QAAS;IAE5B;AACF"}