{"version":3,"sources":["../src/components/AccordionHeader/useAccordionHeader.tsx"],"sourcesContent":["import * as React from 'react';\nimport { getIntrinsicElementProps, useEventCallback, slot, isResolvedShorthand } from '@fluentui/react-utilities';\nimport { useARIAButtonProps } from '@fluentui/react-aria';\nimport type { AccordionHeaderProps, AccordionHeaderState } from './AccordionHeader.types';\nimport { useAccordionContext_unstable } from '../../contexts/accordion';\nimport { ChevronRightRegular } from '@fluentui/react-icons';\nimport { useFluent_unstable as useFluent } from '@fluentui/react-shared-contexts';\nimport { useAccordionItemContext_unstable } from '../../contexts/accordionItem';\nimport { motionTokens } from '@fluentui/react-motion';\n\n/**\n * Returns the props and state required to render the component\n * @param props - AccordionHeader properties\n * @param ref - reference to root HTMLElement of AccordionHeader\n */\nexport const useAccordionHeader_unstable = (\n  props: AccordionHeaderProps,\n  ref: React.Ref<HTMLElement>,\n): AccordionHeaderState => {\n  const { icon, button, expandIcon, inline = false, size = 'medium', expandIconPosition = 'start' } = props;\n  const { value, disabled, open } = useAccordionItemContext_unstable();\n  const requestToggle = useAccordionContext_unstable(ctx => ctx.requestToggle);\n\n  /**\n   * force disabled state on button if accordion isn't collapsible\n   * and this is the only item opened\n   */\n  const disabledFocusable = useAccordionContext_unstable(ctx => !ctx.collapsible && ctx.openItems.length === 1 && open);\n\n  const { dir } = useFluent();\n\n  // Calculate how to rotate the expand icon [>] (ChevronRightRegular)\n  let expandIconRotation: 0 | 90 | -90 | 180;\n  if (expandIconPosition === 'end') {\n    // If expand icon is at the end, the chevron points up [^] when open, and down [v] when closed\n    expandIconRotation = open ? -90 : 90;\n  } else {\n    // Otherwise, the chevron points down [v] when open, and right [>] (or left [<] in RTL) when closed\n    expandIconRotation = open ? 90 : dir !== 'rtl' ? 0 : 180;\n  }\n\n  const buttonSlot = slot.always(button, {\n    elementType: 'button',\n    defaultProps: {\n      disabled,\n      disabledFocusable,\n      'aria-expanded': open,\n      type: 'button',\n    },\n  });\n\n  buttonSlot.onClick = useEventCallback(event => {\n    if (isResolvedShorthand(button)) {\n      button.onClick?.(event);\n    }\n    if (!event.defaultPrevented) {\n      requestToggle({ value, event });\n    }\n  });\n\n  return {\n    disabled,\n    open,\n    size,\n    inline,\n    expandIconPosition,\n    components: {\n      root: 'div',\n      button: 'button',\n      expandIcon: 'span',\n      icon: 'div',\n    },\n    root: slot.always(\n      getIntrinsicElementProps('div', {\n        // FIXME:\n        // `ref` is wrongly assigned to be `HTMLElement` instead of `HTMLDivElement`\n        // but since it would be a breaking change to fix it, we are casting ref to it's proper type\n        ref: ref as React.Ref<HTMLDivElement>,\n        ...props,\n      }),\n      { elementType: 'div' },\n    ),\n    icon: slot.optional(icon, { elementType: 'div' }),\n    expandIcon: slot.optional(expandIcon, {\n      renderByDefault: true,\n      defaultProps: {\n        children: (\n          <ChevronRightRegular\n            style={{\n              transform: `rotate(${expandIconRotation}deg)`,\n              transition: `transform ${motionTokens.durationNormal}ms ease-out`,\n            }}\n          />\n        ),\n        'aria-hidden': true,\n      },\n      elementType: 'span',\n    }),\n    button: useARIAButtonProps(buttonSlot.as, buttonSlot),\n  };\n};\n"],"names":["useAccordionHeader_unstable","props","ref","icon","button","expandIcon","inline","size","expandIconPosition","value","disabled","open","useAccordionItemContext_unstable","requestToggle","useAccordionContext_unstable","ctx","disabledFocusable","collapsible","openItems","length","dir","useFluent","expandIconRotation","buttonSlot","slot","always","elementType","defaultProps","type","onClick","useEventCallback","event","isResolvedShorthand","defaultPrevented","components","root","getIntrinsicElementProps","optional","renderByDefault","children","React","createElement","ChevronRightRegular","style","transform","transition","motionTokens","durationNormal","useARIAButtonProps","as"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAeaA;;;eAAAA;;;;iEAfU;gCAC+D;2BACnD;2BAEU;4BACT;qCACY;+BACC;6BACpB;AAOtB,MAAMA,8BAA8B,CACzCC,OACAC;IAEA,MAAM,EAAEC,IAAI,EAAEC,MAAM,EAAEC,UAAU,EAAEC,SAAS,KAAK,EAAEC,OAAO,QAAQ,EAAEC,qBAAqB,OAAO,EAAE,GAAGP;IACpG,MAAM,EAAEQ,KAAK,EAAEC,QAAQ,EAAEC,IAAI,EAAE,GAAGC,IAAAA,+CAAAA;IAClC,MAAMC,gBAAgBC,IAAAA,uCAAAA,EAA6BC,CAAAA,MAAOA,IAAIF,aAAa;IAE3E;;;GAGC,GACD,MAAMG,oBAAoBF,IAAAA,uCAAAA,EAA6BC,CAAAA,MAAO,CAACA,IAAIE,WAAW,IAAIF,IAAIG,SAAS,CAACC,MAAM,KAAK,KAAKR;IAEhH,MAAM,EAAES,GAAG,EAAE,GAAGC,IAAAA,uCAAAA;IAEhB,oEAAoE;IACpE,IAAIC;IACJ,IAAId,uBAAuB,OAAO;QAChC,8FAA8F;QAC9Fc,qBAAqBX,OAAO,CAAC,KAAK;IACpC,OAAO;QACL,mGAAmG;QACnGW,qBAAqBX,OAAO,KAAKS,QAAQ,QAAQ,IAAI;IACvD;IAEA,MAAMG,aAAaC,oBAAAA,CAAKC,MAAM,CAACrB,QAAQ;QACrCsB,aAAa;QACbC,cAAc;YACZjB;YACAM;YACA,iBAAiBL;YACjBiB,MAAM;QACR;IACF;IAEAL,WAAWM,OAAO,GAAGC,IAAAA,gCAAAA,EAAiBC,CAAAA;QACpC,IAAIC,IAAAA,mCAAAA,EAAoB5B,SAAS;gBAC/BA;YAAAA,CAAAA,kBAAAA,OAAOyB,OAAO,AAAPA,MAAO,QAAdzB,oBAAAA,KAAAA,IAAAA,KAAAA,IAAAA,gBAAAA,IAAAA,CAAAA,QAAiB2B;QACnB;QACA,IAAI,CAACA,MAAME,gBAAgB,EAAE;YAC3BpB,cAAc;gBAAEJ;gBAAOsB;YAAM;QAC/B;IACF;IAEA,OAAO;QACLrB;QACAC;QACAJ;QACAD;QACAE;QACA0B,YAAY;YACVC,MAAM;YACN/B,QAAQ;YACRC,YAAY;YACZF,MAAM;QACR;QACAgC,MAAMX,oBAAAA,CAAKC,MAAM,CACfW,IAAAA,wCAAAA,EAAyB,OAAO;YAC9B,SAAS;YACT,4EAA4E;YAC5E,4FAA4F;YAC5FlC,KAAKA;YACL,GAAGD,KAAK;QACV,IACA;YAAEyB,aAAa;QAAM;QAEvBvB,MAAMqB,oBAAAA,CAAKa,QAAQ,CAAClC,MAAM;YAAEuB,aAAa;QAAM;QAC/CrB,YAAYmB,oBAAAA,CAAKa,QAAQ,CAAChC,YAAY;YACpCiC,iBAAiB;YACjBX,cAAc;gBACZY,UAAAA,WAAAA,GACEC,OAAAC,aAAA,CAACC,+BAAAA,EAAAA;oBACCC,OAAO;wBACLC,WAAW,CAAC,OAAO,EAAEtB,mBAAmB,IAAI,CAAC;wBAC7CuB,YAAY,CAAC,UAAU,EAAEC,yBAAAA,CAAaC,cAAc,CAAC,WAAW,CAAC;oBACnE;;gBAGJ,eAAe;YACjB;YACArB,aAAa;QACf;QACAtB,QAAQ4C,IAAAA,6BAAAA,EAAmBzB,WAAW0B,EAAE,EAAE1B;IAC5C;AACF"}