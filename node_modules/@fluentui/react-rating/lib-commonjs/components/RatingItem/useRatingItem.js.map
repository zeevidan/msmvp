{"version":3,"sources":["../src/components/RatingItem/useRatingItem.tsx"],"sourcesContent":["import * as React from 'react';\nimport { getIntrinsicElementProps, slot, useMergedRefs } from '@fluentui/react-utilities';\nimport { useFocusWithin } from '@fluentui/react-tabster';\nimport type { RatingItemProps, RatingItemState } from './RatingItem.types';\nimport { useRatingItemContextValue_unstable } from '../../contexts/RatingItemContext';\n\nconst defaultItemLabel = (num: number) => num + '';\n\n/**\n * Create the state required to render RatingItem.\n *\n * The returned state can be modified with hooks such as useRatingItemStyles_unstable,\n * before being passed to renderRatingItem_unstable.\n *\n * @param props - props from this instance of RatingItem\n * @param ref - reference to root HTMLElement of RatingItem\n */\nexport const useRatingItem_unstable = (props: RatingItemProps, ref: React.Ref<HTMLSpanElement>): RatingItemState => {\n  const context = useRatingItemContextValue_unstable();\n  const { value = 0 } = props;\n  const { itemLabel = defaultItemLabel, iconFilled: IconFilled, iconOutline: IconOutline } = context;\n\n  const ratingValue = Math.round((context.value || 0) * 2) / 2; // round to the nearest 0.5\n\n  const displayedRatingValue = context.hoveredValue ?? ratingValue;\n\n  const appearance = context.interactive ? 'outline' : 'filled';\n\n  let iconFillWidth;\n  if (context.compact || displayedRatingValue >= value) {\n    iconFillWidth = 1;\n  } else if (displayedRatingValue >= value - 0.5) {\n    iconFillWidth = 0.5;\n  } else {\n    iconFillWidth = 0;\n  }\n\n  const root = slot.always(\n    getIntrinsicElementProps('span', {\n      ref: useMergedRefs(useFocusWithin<HTMLSpanElement>(), ref),\n      ...props,\n    }),\n    { elementType: 'span' },\n  );\n\n  let unselectedIcon;\n  if (iconFillWidth < 1) {\n    unselectedIcon = slot.always(props.unselectedIcon, {\n      defaultProps: {\n        children: appearance === 'filled' ? <IconFilled /> : <IconOutline />,\n        'aria-hidden': true,\n      },\n      elementType: 'div',\n    });\n  }\n\n  let selectedIcon;\n  if (iconFillWidth > 0) {\n    selectedIcon = slot.always(props.selectedIcon, {\n      defaultProps: {\n        children: <IconFilled />,\n        'aria-hidden': true,\n      },\n      elementType: 'div',\n    });\n  }\n\n  let halfValueInput;\n  if (context.interactive && context.step === 0.5) {\n    halfValueInput = slot.always(props.halfValueInput, {\n      defaultProps: {\n        type: 'radio',\n        name: context.name,\n        value: value - 0.5,\n        checked: ratingValue === value - 0.5,\n        'aria-label': itemLabel(value - 0.5),\n        onChange: () => {\n          // This empty onChange handler silences an incorrect React warning about not using onChange for a controlled input.\n          // The parent Rating component has the real onChange handler to listen to change events from this input.\n        },\n      },\n      elementType: 'input',\n    });\n  }\n\n  let fullValueInput;\n  if (context.interactive) {\n    fullValueInput = slot.always(props.fullValueInput, {\n      defaultProps: {\n        type: 'radio',\n        name: context.name,\n        value,\n        checked: ratingValue === value,\n        'aria-label': itemLabel(value),\n        onChange: () => {\n          // This empty onChange handler silences an incorrect React warning about not using onChange for a controlled input.\n          // The parent Rating component has the real onChange handler to listen to change events from this input.\n        },\n      },\n\n      elementType: 'input',\n    });\n  }\n\n  const state: RatingItemState = {\n    appearance,\n    color: context.color,\n    step: context.step,\n    size: context.size,\n    iconFillWidth,\n    value,\n    components: {\n      root: 'span',\n      selectedIcon: 'div',\n      unselectedIcon: 'div',\n      halfValueInput: 'input',\n      fullValueInput: 'input',\n    },\n    root,\n    selectedIcon,\n    unselectedIcon,\n    halfValueInput,\n    fullValueInput,\n  };\n\n  return state;\n};\n"],"names":["useRatingItem_unstable","defaultItemLabel","num","props","ref","context","useRatingItemContextValue_unstable","value","itemLabel","iconFilled","IconFilled","iconOutline","IconOutline","ratingValue","Math","round","displayedRatingValue","hoveredValue","appearance","interactive","iconFillWidth","compact","root","slot","always","getIntrinsicElementProps","useMergedRefs","useFocusWithin","elementType","unselectedIcon","defaultProps","children","React","createElement","selectedIcon","halfValueInput","step","type","name","checked","onChange","fullValueInput","state","color","size","components"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}