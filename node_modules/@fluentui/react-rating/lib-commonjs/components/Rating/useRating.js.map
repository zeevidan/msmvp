{"version":3,"sources":["../src/components/Rating/useRating.tsx"],"sourcesContent":["import * as React from 'react';\nimport {\n  getIntrinsicElementProps,\n  isHTMLElement,\n  mergeCallbacks,\n  slot,\n  useControllableState,\n  useId,\n} from '@fluentui/react-utilities';\nimport type { RatingProps, RatingState } from './Rating.types';\nimport { RatingItem } from '../../RatingItem';\nimport { StarFilled, StarRegular } from '@fluentui/react-icons';\n\n/**\n * Create the state required to render Rating.\n *\n * The returned state can be modified with hooks such as useRatingStyles_unstable,\n * before being passed to renderRating_unstable.\n *\n * @param props - props from this instance of Rating\n * @param ref - reference to root HTMLElement of Rating\n */\nexport const useRating_unstable = (props: RatingProps, ref: React.Ref<HTMLDivElement>): RatingState => {\n  const generatedName = useId('rating-');\n  const {\n    color = 'neutral',\n    iconFilled = StarFilled,\n    iconOutline = StarRegular,\n    max = 5,\n    name = generatedName,\n    onChange,\n    step = 1,\n    size = 'extra-large',\n    itemLabel,\n  } = props;\n\n  const [value, setValue] = useControllableState({\n    state: props.value,\n    defaultState: props.defaultValue,\n    initialState: 0,\n  });\n\n  const isRatingRadioItem = (target: EventTarget): target is HTMLInputElement =>\n    isHTMLElement(target, { constructorName: 'HTMLInputElement' }) && target.type === 'radio' && target.name === name;\n\n  const [hoveredValue, setHoveredValue] = React.useState<number | undefined>(undefined);\n\n  // Generate the child RatingItems and memoize them to prevent unnecessary re-rendering\n  const rootChildren = React.useMemo(() => {\n    return Array.from(Array(max), (_, i) => <RatingItem value={i + 1} key={i + 1} />);\n  }, [max]);\n\n  const state: RatingState = {\n    color,\n    iconFilled,\n    iconOutline,\n    name,\n    step,\n    size,\n    itemLabel,\n    value,\n    hoveredValue,\n    components: {\n      root: 'div',\n    },\n    root: slot.always(\n      getIntrinsicElementProps(\n        'div',\n        {\n          ref,\n          children: rootChildren,\n          role: 'radiogroup',\n          ...props,\n        },\n        ['onChange'],\n      ),\n      { elementType: 'div' },\n    ),\n  };\n\n  state.root.onChange = ev => {\n    if (isRatingRadioItem(ev.target)) {\n      const newValue = parseFloat(ev.target.value);\n      if (!isNaN(newValue)) {\n        setValue(newValue);\n        onChange?.(ev, { type: 'change', event: ev, value: newValue });\n      }\n    }\n  };\n  state.root.onMouseOver = mergeCallbacks(props.onMouseOver, ev => {\n    if (isRatingRadioItem(ev.target)) {\n      const newValue = parseFloat(ev.target.value);\n      if (!isNaN(newValue)) {\n        setHoveredValue(newValue);\n      }\n    }\n  });\n  state.root.onMouseLeave = mergeCallbacks(props.onMouseLeave, ev => {\n    setHoveredValue(undefined);\n  });\n\n  return state;\n};\n"],"names":["useRating_unstable","props","ref","generatedName","useId","color","iconFilled","StarFilled","iconOutline","StarRegular","max","name","onChange","step","size","itemLabel","value","setValue","useControllableState","state","defaultState","defaultValue","initialState","isRatingRadioItem","target","isHTMLElement","constructorName","type","hoveredValue","setHoveredValue","React","useState","undefined","rootChildren","useMemo","Array","from","_","i","createElement","RatingItem","key","components","root","slot","always","getIntrinsicElementProps","children","role","elementType","ev","newValue","parseFloat","isNaN","event","onMouseOver","mergeCallbacks","onMouseLeave"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAsBaA;;;eAAAA;;;;iEAtBU;gCAQhB;4BAEoB;4BACa;AAWjC,MAAMA,qBAAqB,CAACC,OAAoBC;IACrD,MAAMC,gBAAgBC,IAAAA,qBAAAA,EAAM;IAC5B,MAAM,EACJC,QAAQ,SAAS,EACjBC,aAAaC,sBAAU,EACvBC,cAAcC,uBAAW,EACzBC,MAAM,CAAC,EACPC,OAAOR,aAAa,EACpBS,QAAQ,EACRC,OAAO,CAAC,EACRC,OAAO,aAAa,EACpBC,SAAS,EACV,GAAGd;IAEJ,MAAM,CAACe,OAAOC,SAAS,GAAGC,IAAAA,oCAAAA,EAAqB;QAC7CC,OAAOlB,MAAMe,KAAK;QAClBI,cAAcnB,MAAMoB,YAAY;QAChCC,cAAc;IAChB;IAEA,MAAMC,oBAAoB,CAACC,SACzBC,IAAAA,6BAAAA,EAAcD,QAAQ;YAAEE,iBAAiB;QAAmB,MAAMF,OAAOG,IAAI,KAAK,WAAWH,OAAOb,IAAI,KAAKA;IAE/G,MAAM,CAACiB,cAAcC,gBAAgB,GAAGC,OAAMC,QAAQ,CAAqBC;IAE3E,sFAAsF;IACtF,MAAMC,eAAeH,OAAMI,OAAO,CAAC;QACjC,OAAOC,MAAMC,IAAI,CAACD,MAAMzB,MAAM,CAAC2B,GAAGC,IAAAA,WAAAA,GAAMR,OAAAS,aAAA,CAACC,sBAAAA,EAAAA;gBAAWxB,OAAOsB,IAAI;gBAAGG,KAAKH,IAAI;;IAC7E,GAAG;QAAC5B;KAAI;IAER,MAAMS,QAAqB;QACzBd;QACAC;QACAE;QACAG;QACAE;QACAC;QACAC;QACAC;QACAY;QACAc,YAAY;YACVC,MAAM;QACR;QACAA,MAAMC,oBAAAA,CAAKC,MAAM,CACfC,IAAAA,wCAAAA,EACE,OACA;YACE5C;YACA6C,UAAUd;YACVe,MAAM;YACN,GAAG/C,KAAK;QACV,GACA;YAAC;SAAW,GAEd;YAAEgD,aAAa;QAAM;IAEzB;IAEA9B,MAAMwB,IAAI,CAAC/B,QAAQ,GAAGsC,CAAAA;QACpB,IAAI3B,kBAAkB2B,GAAG1B,MAAM,GAAG;YAChC,MAAM2B,WAAWC,WAAWF,GAAG1B,MAAM,CAACR,KAAK;YAC3C,IAAI,CAACqC,MAAMF,WAAW;gBACpBlC,SAASkC;gBACTvC,aAAAA,QAAAA,aAAAA,KAAAA,IAAAA,KAAAA,IAAAA,SAAWsC,IAAI;oBAAEvB,MAAM;oBAAU2B,OAAOJ;oBAAIlC,OAAOmC;gBAAS;YAC9D;QACF;IACF;IACAhC,MAAMwB,IAAI,CAACY,WAAW,GAAGC,IAAAA,8BAAAA,EAAevD,MAAMsD,WAAW,EAAEL,CAAAA;QACzD,IAAI3B,kBAAkB2B,GAAG1B,MAAM,GAAG;YAChC,MAAM2B,WAAWC,WAAWF,GAAG1B,MAAM,CAACR,KAAK;YAC3C,IAAI,CAACqC,MAAMF,WAAW;gBACpBtB,gBAAgBsB;YAClB;QACF;IACF;IACAhC,MAAMwB,IAAI,CAACc,YAAY,GAAGD,IAAAA,8BAAAA,EAAevD,MAAMwD,YAAY,EAAEP,CAAAA;QAC3DrB,gBAAgBG;IAClB;IAEA,OAAOb;AACT"}