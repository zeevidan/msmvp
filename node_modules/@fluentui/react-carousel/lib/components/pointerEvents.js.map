{"version":3,"sources":["../src/components/pointerEvents.ts"],"sourcesContent":["import type { CreatePluginType, EmblaCarouselType, OptionsHandlerType } from 'embla-carousel';\nimport { carouselClassNames } from '../Carousel';\n\nexport type PointerEventPluginOptions = {\n  onSelectViaDrag: (event: PointerEvent | MouseEvent, index: number) => void;\n};\n\nexport type PointerEventPlugin = CreatePluginType<{}, PointerEventPluginOptions>;\n\nexport function pointerEventPlugin(options: PointerEventPluginOptions): PointerEventPlugin {\n  let emblaApi: EmblaCarouselType;\n  let pointerEvent: PointerEvent | MouseEvent | undefined;\n\n  function documentDownListener(event: PointerEvent | MouseEvent) {\n    const targetDocument = emblaApi.containerNode().ownerDocument;\n\n    if (event.target) {\n      const targetNode = event.target as Element;\n      if (targetNode.classList.contains(carouselClassNames.root) || emblaApi.containerNode().contains(targetNode)) {\n        pointerEvent = event;\n      }\n    }\n\n    targetDocument.removeEventListener('mousedown', documentDownListener);\n    targetDocument.removeEventListener('pointerdown', documentDownListener);\n  }\n\n  function pointerUpListener() {\n    const targetDocument = emblaApi.containerNode().ownerDocument;\n\n    targetDocument.addEventListener('mousedown', documentDownListener);\n    targetDocument.addEventListener('pointerdown', documentDownListener);\n  }\n\n  function clearPointerEvent() {\n    pointerEvent = undefined;\n    pointerUpListener();\n  }\n\n  function selectListener() {\n    if (pointerEvent) {\n      const newIndex = emblaApi.selectedScrollSnap() ?? 0;\n\n      options.onSelectViaDrag(pointerEvent, newIndex);\n    }\n    clearPointerEvent();\n  }\n\n  function init(emblaApiInstance: EmblaCarouselType, optionsHandler: OptionsHandlerType): void {\n    emblaApi = emblaApiInstance;\n\n    // Initialize the listener for first mouse/pointerDown event\n    const targetDocument = emblaApi.containerNode().ownerDocument;\n    targetDocument.addEventListener('mousedown', documentDownListener);\n    targetDocument.addEventListener('pointerdown', documentDownListener);\n\n    emblaApi.on('pointerUp', pointerUpListener);\n    emblaApi.on('select', selectListener);\n    // Settle is used to clear pointer in cases where active index does not change\n    emblaApi.on('settle', clearPointerEvent);\n  }\n\n  function destroy(): void {\n    const targetDocument = emblaApi.containerNode().ownerDocument;\n    targetDocument.removeEventListener('mousedown', documentDownListener);\n    targetDocument.removeEventListener('pointerdown', documentDownListener);\n    emblaApi.off('pointerUp', pointerUpListener);\n    emblaApi.off('select', selectListener);\n    emblaApi.off('settle', clearPointerEvent);\n  }\n\n  return {\n    name: 'pointerEvent',\n    options,\n    init,\n    destroy,\n  };\n}\n"],"names":["carouselClassNames","pointerEventPlugin","options","emblaApi","pointerEvent","documentDownListener","event","targetDocument","containerNode","ownerDocument","target","targetNode","classList","contains","root","removeEventListener","pointerUpListener","addEventListener","clearPointerEvent","undefined","selectListener","newIndex","selectedScrollSnap","onSelectViaDrag","init","emblaApiInstance","optionsHandler","on","destroy","off","name"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AACA,SAASA,kBAAkB,QAAQ,cAAc;AAQjD,OAAO,SAASC,mBAAmBC,OAAkC;IACnE,IAAIC;IACJ,IAAIC;IAEJ,SAASC,qBAAqBC,KAAgC;QAC5D,MAAMC,iBAAiBJ,SAASK,aAAa,GAAGC,aAAa;QAE7D,IAAIH,MAAMI,MAAM,EAAE;YAChB,MAAMC,aAAaL,MAAMI,MAAM;YAC/B,IAAIC,WAAWC,SAAS,CAACC,QAAQ,CAACb,mBAAmBc,IAAI,KAAKX,SAASK,aAAa,GAAGK,QAAQ,CAACF,aAAa;gBAC3GP,eAAeE;YACjB;QACF;QAEAC,eAAeQ,mBAAmB,CAAC,aAAaV;QAChDE,eAAeQ,mBAAmB,CAAC,eAAeV;IACpD;IAEA,SAASW;QACP,MAAMT,iBAAiBJ,SAASK,aAAa,GAAGC,aAAa;QAE7DF,eAAeU,gBAAgB,CAAC,aAAaZ;QAC7CE,eAAeU,gBAAgB,CAAC,eAAeZ;IACjD;IAEA,SAASa;QACPd,eAAee;QACfH;IACF;IAEA,SAASI;QACP,IAAIhB,cAAc;gBACCD;YAAjB,MAAMkB,WAAWlB,CAAAA,+BAAAA,SAASmB,kBAAkB,gBAA3BnB,0CAAAA,+BAAiC;YAElDD,QAAQqB,eAAe,CAACnB,cAAciB;QACxC;QACAH;IACF;IAEA,SAASM,KAAKC,gBAAmC,EAAEC,cAAkC;QACnFvB,WAAWsB;QAEX,4DAA4D;QAC5D,MAAMlB,iBAAiBJ,SAASK,aAAa,GAAGC,aAAa;QAC7DF,eAAeU,gBAAgB,CAAC,aAAaZ;QAC7CE,eAAeU,gBAAgB,CAAC,eAAeZ;QAE/CF,SAASwB,EAAE,CAAC,aAAaX;QACzBb,SAASwB,EAAE,CAAC,UAAUP;QACtB,8EAA8E;QAC9EjB,SAASwB,EAAE,CAAC,UAAUT;IACxB;IAEA,SAASU;QACP,MAAMrB,iBAAiBJ,SAASK,aAAa,GAAGC,aAAa;QAC7DF,eAAeQ,mBAAmB,CAAC,aAAaV;QAChDE,eAAeQ,mBAAmB,CAAC,eAAeV;QAClDF,SAAS0B,GAAG,CAAC,aAAab;QAC1Bb,SAAS0B,GAAG,CAAC,UAAUT;QACvBjB,SAAS0B,GAAG,CAAC,UAAUX;IACzB;IAEA,OAAO;QACLY,MAAM;QACN5B;QACAsB;QACAI;IACF;AACF"}