{"version":3,"sources":["../src/components/CarouselViewport/useCarouselViewport.ts"],"sourcesContent":["import * as React from 'react';\nimport { getIntrinsicElementProps, mergeCallbacks, slot, useMergedRefs } from '@fluentui/react-utilities';\nimport type { CarouselViewportProps, CarouselViewportState } from './CarouselViewport.types';\nimport { useCarouselContext_unstable as useCarouselContext } from '../CarouselContext';\n\n/**\n * Create the state required to render CarouselViewport.\n *\n * The returned state can be modified with hooks such as useCarouselViewportStyles_unstable,\n * before being passed to renderCarouselViewport_unstable.\n *\n * @param props - props from this instance of CarouselViewport\n * @param ref - reference to root HTMLDivElement of CarouselViewport\n */\nexport const useCarouselViewport_unstable = (\n  props: CarouselViewportProps,\n  ref: React.Ref<HTMLDivElement>,\n): CarouselViewportState => {\n  const hasFocus = React.useRef(false);\n  const hasMouse = React.useRef(false);\n  const viewportRef = useCarouselContext(ctx => ctx.viewportRef);\n  const enableAutoplay = useCarouselContext(ctx => ctx.enableAutoplay);\n\n  const handleFocusCapture = React.useCallback(\n    (e: React.FocusEvent) => {\n      hasFocus.current = true;\n      // Will pause autoplay when focus is captured within viewport (if autoplay is initialized)\n      enableAutoplay(false, true);\n    },\n    [enableAutoplay],\n  );\n\n  const handleBlurCapture = React.useCallback(\n    (e: React.FocusEvent) => {\n      // Will enable autoplay (if initialized) when focus exits viewport\n      if (!e.currentTarget.contains(e.relatedTarget)) {\n        hasFocus.current = false;\n        if (!hasMouse.current) {\n          enableAutoplay(true, true);\n        }\n      }\n    },\n    [enableAutoplay],\n  );\n\n  const handleMouseEnter = React.useCallback(\n    (event: React.MouseEvent) => {\n      hasMouse.current = true;\n      enableAutoplay(false, true);\n    },\n    [enableAutoplay],\n  );\n  const handleMouseLeave = React.useCallback(\n    (event: React.MouseEvent) => {\n      hasMouse.current = false;\n      if (!hasFocus.current) {\n        enableAutoplay(true, true);\n      }\n    },\n    [enableAutoplay],\n  );\n\n  const onFocusCapture = mergeCallbacks(props.onFocusCapture, handleFocusCapture);\n  const onBlurCapture = mergeCallbacks(props.onBlurCapture, handleBlurCapture);\n  const onMouseEnter = mergeCallbacks(props.onMouseEnter, handleMouseEnter);\n  const onMouseLeave = mergeCallbacks(props.onMouseLeave, handleMouseLeave);\n\n  return {\n    components: {\n      root: 'div',\n    },\n    root: slot.always(\n      getIntrinsicElementProps('div', {\n        ref: useMergedRefs(ref, viewportRef),\n        role: 'presentation',\n        // Draggable ensures dragging is supported (even if not enabled)\n        draggable: true,\n        ...props,\n        onFocusCapture,\n        onBlurCapture,\n        onMouseEnter,\n        onMouseLeave,\n      }),\n      { elementType: 'div' },\n    ),\n  };\n};\n"],"names":["React","getIntrinsicElementProps","mergeCallbacks","slot","useMergedRefs","useCarouselContext_unstable","useCarouselContext","useCarouselViewport_unstable","props","ref","hasFocus","useRef","hasMouse","viewportRef","ctx","enableAutoplay","handleFocusCapture","useCallback","e","current","handleBlurCapture","currentTarget","contains","relatedTarget","handleMouseEnter","event","handleMouseLeave","onFocusCapture","onBlurCapture","onMouseEnter","onMouseLeave","components","root","always","role","draggable","elementType"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,wBAAwB,EAAEC,cAAc,EAAEC,IAAI,EAAEC,aAAa,QAAQ,4BAA4B;AAE1G,SAASC,+BAA+BC,kBAAkB,QAAQ,qBAAqB;AAEvF;;;;;;;;CAQC,GACD,OAAO,MAAMC,+BAA+B,CAC1CC,OACAC;IAEA,MAAMC,WAAWV,MAAMW,MAAM,CAAC;IAC9B,MAAMC,WAAWZ,MAAMW,MAAM,CAAC;IAC9B,MAAME,cAAcP,mBAAmBQ,CAAAA,MAAOA,IAAID,WAAW;IAC7D,MAAME,iBAAiBT,mBAAmBQ,CAAAA,MAAOA,IAAIC,cAAc;IAEnE,MAAMC,qBAAqBhB,MAAMiB,WAAW,CAC1C,CAACC;QACCR,SAASS,OAAO,GAAG;QACnB,0FAA0F;QAC1FJ,eAAe,OAAO;IACxB,GACA;QAACA;KAAe;IAGlB,MAAMK,oBAAoBpB,MAAMiB,WAAW,CACzC,CAACC;QACC,kEAAkE;QAClE,IAAI,CAACA,EAAEG,aAAa,CAACC,QAAQ,CAACJ,EAAEK,aAAa,GAAG;YAC9Cb,SAASS,OAAO,GAAG;YACnB,IAAI,CAACP,SAASO,OAAO,EAAE;gBACrBJ,eAAe,MAAM;YACvB;QACF;IACF,GACA;QAACA;KAAe;IAGlB,MAAMS,mBAAmBxB,MAAMiB,WAAW,CACxC,CAACQ;QACCb,SAASO,OAAO,GAAG;QACnBJ,eAAe,OAAO;IACxB,GACA;QAACA;KAAe;IAElB,MAAMW,mBAAmB1B,MAAMiB,WAAW,CACxC,CAACQ;QACCb,SAASO,OAAO,GAAG;QACnB,IAAI,CAACT,SAASS,OAAO,EAAE;YACrBJ,eAAe,MAAM;QACvB;IACF,GACA;QAACA;KAAe;IAGlB,MAAMY,iBAAiBzB,eAAeM,MAAMmB,cAAc,EAAEX;IAC5D,MAAMY,gBAAgB1B,eAAeM,MAAMoB,aAAa,EAAER;IAC1D,MAAMS,eAAe3B,eAAeM,MAAMqB,YAAY,EAAEL;IACxD,MAAMM,eAAe5B,eAAeM,MAAMsB,YAAY,EAAEJ;IAExD,OAAO;QACLK,YAAY;YACVC,MAAM;QACR;QACAA,MAAM7B,KAAK8B,MAAM,CACfhC,yBAAyB,OAAO;YAC9BQ,KAAKL,cAAcK,KAAKI;YACxBqB,MAAM;YACN,gEAAgE;YAChEC,WAAW;YACX,GAAG3B,KAAK;YACRmB;YACAC;YACAC;YACAC;QACF,IACA;YAAEM,aAAa;QAAM;IAEzB;AACF,EAAE"}